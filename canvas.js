data = JSON.parse('{"status":true,"message":"获取数据成功","data":{"departmentStructure":{"children":[{"id":"986bbe6c9fba4039981ddbddaa5d3f68","admin_id":"0","admin_name":"","name":"asda","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":5,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":5},{"id":"6170ed2796a94fa29065eb2428d96769","admin_id":"0","admin_name":"","name":"1","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":1,"children_ids":["42ff025cdad14649ae66ccde4ea96245","b7906420a9944de38aacf8f75c10b09f"],"division_id":"","division_settable":true,"children":[{"id":"42ff025cdad14649ae66ccde4ea96245","admin_id":"0","admin_name":"","name":"sda","parent_id":"6170ed2796a94fa29065eb2428d96769","is_root":0,"employee_count":1,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":1},{"id":"b7906420a9944de38aacf8f75c10b09f","admin_id":"0","admin_name":"","name":"gsd","parent_id":"6170ed2796a94fa29065eb2428d96769","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0}],"employee_count_with_sub":2},{"id":"fc4f79b0857d4f13b25ea280c07f99c1","admin_id":"0","admin_name":"","name":"13","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"37e02f869eeb4d258af14ba23b4db25a","admin_id":"0","admin_name":"","name":"3","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"44b4cbd0250a497ebe6264fb7ec321e6","admin_id":"0","admin_name":"","name":"6","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"f6e06cca73d24eb7a8fc9925bea32bbf","admin_id":"0","admin_name":"","name":"啊啊啊啊","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"1c96fe89daf245fbae5d19fc2684417c","admin_id":"0","admin_name":"","name":"16","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"98d2012e85a24ffda973ae92da3d482a","admin_id":"0","admin_name":"","name":"15","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"fc225a5ae06e4abaa2922363783d0955","admin_id":"0","admin_name":"","name":"4","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"children":[{"children":[{"id":"5cf243a40c9947e5ad1a4633bf544b66","admin_id":"0","admin_name":"","name":"吃吃吃","parent_id":"ade89dc64842426ea2a3525776f5d277","is_root":0,"employee_count":1,"children_ids":["5105f2f4d7c347f8bbe9b580656c3902"],"division_id":"","division_settable":false,"children":[{"children":[{"id":"7e762f8aa0a14120b3f1b2a0cd326e7d","admin_id":"0","admin_name":"","name":"热热热","parent_id":"5105f2f4d7c347f8bbe9b580656c3902","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0}],"id":"5105f2f4d7c347f8bbe9b580656c3902","admin_id":"0","admin_name":"","name":"哈哈哈","parent_id":"5cf243a40c9947e5ad1a4633bf544b66","is_root":0,"employee_count":0,"children_ids":["7e762f8aa0a14120b3f1b2a0cd326e7d"],"division_id":"","division_settable":false,"employee_count_with_sub":0}],"employee_count_with_sub":1}],"id":"ade89dc64842426ea2a3525776f5d277","admin_id":"0","admin_name":"","name":"111","parent_id":"d0be09d6850c41fba6e93a9bd4fea43b","is_root":0,"employee_count":0,"children_ids":["5cf243a40c9947e5ad1a4633bf544b66"],"division_id":"","division_settable":false,"employee_count_with_sub":1},{"id":"adab5bd101f24f6c94cc8e1359d90638","admin_id":"0","admin_name":"","name":"asd","parent_id":"d0be09d6850c41fba6e93a9bd4fea43b","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0},{"children":[{"id":"1ec7455e9ef2464690437a0dea4d77f1","admin_id":"0","admin_name":"","name":"fwea","parent_id":"135368e95b2545159585a0537d1a851f","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0},{"id":"5421a64e699d453eb082b1545c815fa0","admin_id":"0","admin_name":"","name":"公司的","parent_id":"135368e95b2545159585a0537d1a851f","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0},{"id":"e938ef19d70f4c4c90071c89520f2dcf","admin_id":"0","admin_name":"","name":"是奉公守法个开始发力放假啊","parent_id":"135368e95b2545159585a0537d1a851f","is_root":0,"employee_count":2,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":2}],"id":"135368e95b2545159585a0537d1a851f","admin_id":"370fee2c65b911e688db00163e00371a","admin_name":"老大","name":"23423","parent_id":"d0be09d6850c41fba6e93a9bd4fea43b","is_root":0,"employee_count":0,"children_ids":["1ec7455e9ef2464690437a0dea4d77f1","5421a64e699d453eb082b1545c815fa0","e938ef19d70f4c4c90071c89520f2dcf"],"division_id":"","division_settable":false,"employee_count_with_sub":2}],"id":"d0be09d6850c41fba6e93a9bd4fea43b","admin_id":"0","admin_name":"","name":"sadsg","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":["135368e95b2545159585a0537d1a851f","adab5bd101f24f6c94cc8e1359d90638","ade89dc64842426ea2a3525776f5d277"],"division_id":"44e415a7469645d7ba2cf31ca35f2cc3","division_settable":false,"employee_count_with_sub":3},{"id":"bdb11c7ad02f49898cd817ad86998f48","admin_id":"0","admin_name":"","name":"2","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"976681d291144e2ea7a9fbeecd5ead0e","admin_id":"0","admin_name":"","name":"9","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"bf18a54171764143b6d43e53ac32d8ba","admin_id":"0","admin_name":"","name":"10","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"73f5bffcc28745cc8453c1816afb7c6e","admin_id":"0","admin_name":"","name":"8","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"children":[{"id":"0a75a85bbbae4eb09d61877fba0cc0ee","admin_id":"0","admin_name":"","name":"12321","parent_id":"380a8af9f6f44dad92d09304ba1ae2b5","is_root":0,"employee_count":0,"children_ids":["a67b58cd0ba4403492d53239cab7cc5c"],"division_id":"","division_settable":false,"children":[{"id":"a67b58cd0ba4403492d53239cab7cc5c","admin_id":"0","admin_name":"","name":"adsf","parent_id":"0a75a85bbbae4eb09d61877fba0cc0ee","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0}],"employee_count_with_sub":0},{"id":"cef8fafab99244fab8cb2c6b6c1be4f7","admin_id":"c790927b669d11e688db00163e00371a","admin_name":"加多宝","name":"秘书处","parent_id":"380a8af9f6f44dad92d09304ba1ae2b5","is_root":0,"employee_count":4,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":4},{"id":"e95ebeb21d364892a29bb172ed83dda2","admin_id":"6b5ef9a568e011e688db00163e00371a","admin_name":"张三丰1","name":"总裁办－二级1","parent_id":"380a8af9f6f44dad92d09304ba1ae2b5","is_root":0,"employee_count":1,"children_ids":["33fd29a0788142f5864c518d819aab30"],"division_id":"","division_settable":false,"children":[{"id":"33fd29a0788142f5864c518d819aab30","admin_id":"0","admin_name":"","name":"3eeqe","parent_id":"e95ebeb21d364892a29bb172ed83dda2","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":0}],"employee_count_with_sub":1},{"id":"a7e145d9024d4fad842510de70d73c7e","admin_id":"0","admin_name":"","name":"测试","parent_id":"380a8af9f6f44dad92d09304ba1ae2b5","is_root":0,"employee_count":23,"children_ids":[],"division_id":"","division_settable":false,"employee_count_with_sub":23}],"id":"380a8af9f6f44dad92d09304ba1ae2b5","admin_id":"0","admin_name":"","name":"总裁办","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":["0a75a85bbbae4eb09d61877fba0cc0ee","a7e145d9024d4fad842510de70d73c7e","cef8fafab99244fab8cb2c6b6c1be4f7","e95ebeb21d364892a29bb172ed83dda2"],"division_id":"dd2dc2055efc40d8993ffa44033638ba","division_settable":false,"employee_count_with_sub":28},{"id":"cf309a49579b47e0b323fbc9a0c6b3d0","admin_id":"0","admin_name":"","name":"7","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"4bf064bdce044deb93b659b67cf3e6ca","admin_id":"0","admin_name":"","name":"11","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"6c41a73e5b2e408abfcd3cd473bffb2a","admin_id":"0","admin_name":"","name":"5","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"456d92529ac8421e82141a47d98560ec","admin_id":"0","admin_name":"","name":"21","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0},{"id":"8c681addd146438295aef80e4940fe48","admin_id":"0","admin_name":"","name":"·14","parent_id":"e3caf5225fb141e3b2a754414a215ec1","is_root":0,"employee_count":0,"children_ids":[],"division_id":"","division_settable":true,"employee_count_with_sub":0}],"id":"e3caf5225fb141e3b2a754414a215ec1","admin_id":"370fee2c65b911e688db00163e00371a","admin_name":"老大","name":"薪人薪事-z梦","parent_id":"0","is_root":1,"employee_count":41,"children_ids":["1c96fe89daf245fbae5d19fc2684417c","37e02f869eeb4d258af14ba23b4db25a","380a8af9f6f44dad92d09304ba1ae2b5","44b4cbd0250a497ebe6264fb7ec321e6","456d92529ac8421e82141a47d98560ec","4bf064bdce044deb93b659b67cf3e6ca","6170ed2796a94fa29065eb2428d96769","6c41a73e5b2e408abfcd3cd473bffb2a","73f5bffcc28745cc8453c1816afb7c6e","8c681addd146438295aef80e4940fe48","976681d291144e2ea7a9fbeecd5ead0e","986bbe6c9fba4039981ddbddaa5d3f68","98d2012e85a24ffda973ae92da3d482a","bdb11c7ad02f49898cd817ad86998f48","bf18a54171764143b6d43e53ac32d8ba","cf309a49579b47e0b323fbc9a0c6b3d0","d0be09d6850c41fba6e93a9bd4fea43b","f6e06cca73d24eb7a8fc9925bea32bbf","fc225a5ae06e4abaa2922363783d0955","fc4f79b0857d4f13b25ea280c07f99c1"],"division_id":"","division_settable":false,"employee_count_with_sub":79},"leftEmployeeCount":41,"isDivisionOpen":1,"isInDivision":false}}')

console.log(data)

//组织架构每个小框框
function Node(obj){
	this.name = obj.name;
	this.admin = obj.admin_name;
	this.pa = obj.pa;
	this.children = obj.children;
	this.startX = obj.startX;
	this.startY = obj.startY;
	this.canvas = document.createElement('canvas');
	this.ctx = this.canvas.getContext('2d');
	this.canvas.width = 100;
	this.canvas.height = 100;
	this.init();

	return this.canvas
}

Node.prototype = {
	init: function(){
		var t = this;

		t.ctx.beginPath();
		t.roundedRect(0, 0, 50, 50, 100);
		t.ctx.strokeStyle = 'blue';
		t.ctx.fillStyle = 'red';
		t.ctx.stroke();
		t.ctx.fill();
	},
	roundedRect: function(cornerX, cornerY, width, height, cornerRadius) {
		var t = this;
		if(width > 0){
			t.ctx.moveTo(cornerX + cornerRadius, cornerY);
		}else{
			t.ctx.moveTo(cornerX - cornerRadius, cornerY);
		}
		t.ctx.arcTo(cornerX+width,cornerY,cornerX + width,cornerY+height,cornerRadius);
		t.ctx.arcTo(cornerX+width,cornerY + height,cornerX,cornerY+height,cornerRadius);
		t.ctx.arcTo(cornerX,cornerY+height,cornerX,cornerY,cornerRadius);
		
		if(width> 0) {
			t.ctx.arcTo(cornerX,cornerY,cornerX+cornerRadius,cornerY,cornerRadius);
		}
		else{
			t.ctx.arcTo(cornerX,cornerY,cornerX-cornerRadius,cornerY,cornerRadius);
		}
	}
}



//canvasTree
function CanvasTree(obj){
	this.canvas = document.getElementById('canvasTree');
	this.ctx = this.canvas.getContext('2d');
	this.width = obj.width;
	this.height = obj.height;
	this.data = obj.data.data.departmentStructure;

	this.canvas.width = this.width;
	this.canvas.height = this.height;

	this.init();
	this.start();
}

CanvasTree.prototype = {
	init:function(){
		var t = this;
		//遍历data，加上编号
		t.tryNode = new Node(this.data);
		
	},

	start:function(){
		var t = this;
            t.loop = true;
        var raf = window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function (callback){window.setTimeout(callback, 17);};
		function ani(){
            if(!t.loop){return;}
            t.ctx.clearRect(0,0,t.canvas.width,t.canvas.height);
            
            //主循环体
            t.ctx.drawImage(t.tryNode,0,0)


            raf(ani);
        }
        ani();
	},
	stop:function(){
		this.loop = false
	}
}



new CanvasTree({
	width:600,
	height:400,
	data:data})